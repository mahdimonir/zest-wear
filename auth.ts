import { prisma } from "@/lib/prisma";import bcrypt from "bcryptjs";import NextAuth from "next-auth";import Credentials from "next-auth/providers/credentials";import { z } from "zod";const signInSchema = z.object({    identifier: z.string().min(1, "Email or Phone is required"),    password: z.string().min(6, "Password must be at least 6 characters"),});export const { handlers, signIn, signOut, auth } = NextAuth({    providers: [        Credentials({            credentials: {                identifier: { label: "Email or Phone", type: "text" },                password: { label: "Password", type: "password" },            },            authorize: async (credentials) => {                const { identifier, password } = await signInSchema.parseAsync(credentials);                const user = await prisma.user.findFirst({                    where: {                        OR: [                            { email: identifier },                            { phoneNumber: identifier },                        ]                    }                });                if (!user || !user.password) {                    return null;                }                const isPasswordValid = await bcrypt.compare(password, user.password);                if (!isPasswordValid) {                    return null;                }                return {                    id: user.id,                    name: user.name,                    email: user.email,                    image: user.imageUrl,                    imageUrl: user.imageUrl,                };            },        }),    ],    pages: {        signIn: "/sign-in",    },    callbacks: {        async jwt({ token, user }) {            if (user) {                token.id = user.id;                token.imageUrl = user.imageUrl;            }            return token;        },        async session({ session, token }) {            if (session.user && token.id) {                session.user.id = token.id as string;                session.user.imageUrl = token.imageUrl as string | null | undefined;            }            return session;        }    },    session: {        strategy: "jwt",    },    secret: process.env.AUTH_SECRET || "super-secret-secret", });